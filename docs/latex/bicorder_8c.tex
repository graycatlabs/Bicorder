\hypertarget{bicorder_8c}{}\section{bicorder.\+c File Reference}
\label{bicorder_8c}\index{bicorder.\+c@{bicorder.\+c}}


A Tricorder inspired project using the Gray Cat Labs Moon\+Lander.  


{\ttfamily \#include \char`\"{}bicorder.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}chip.\+h\char`\"{}}\\*
{\ttfamily \#include $<$cr\+\_\+section\+\_\+macros.\+h$>$}\\*
{\ttfamily \#include \char`\"{}Moon\+Lander.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Moon\+Lander-\/i2c.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}e\+G\+F\+X.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}e\+G\+F\+X\+\_\+\+Driver\+\_\+\+C12832\+A\+\_\+\+L\+P\+C824.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Fonts/\+F\+O\+N\+T\+\_\+3\+\_\+5\+\_\+1\+B\+P\+P.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}htu21d.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}hmc5883l.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gcl-\/fixedpoint.\+h\char`\"{}}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include \char`\"{}bicorder-\/compass.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}bicorder-\/plotter.\+h\char`\"{}}\\*
Include dependency graph for bicorder.\+c\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{bicorder_8c_adab76f1253da89e657056817a3a9a11a}{gpio\+Init} (void)\hypertarget{bicorder_8c_adab76f1253da89e657056817a3a9a11a}{}\label{bicorder_8c_adab76f1253da89e657056817a3a9a11a}

\begin{DoxyCompactList}\small\item\em G\+P\+IO initialization. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_acb72a5b72c169f53d60303e2fe328604}{interrupt\+Init} (void)\hypertarget{bicorder_8c_acb72a5b72c169f53d60303e2fe328604}{}\label{bicorder_8c_acb72a5b72c169f53d60303e2fe328604}

\begin{DoxyCompactList}\small\item\em Interrupt initialization,. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_afd645b17cf0581bcaa22c56011c775e4}{adc\+Init} (void)
\begin{DoxyCompactList}\small\item\em A\+DC initialization. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_a3ecb5d51db5dae1e4a0e410c3bb246ab}{delayms} (uint16\+\_\+t ms)\hypertarget{bicorder_8c_a3ecb5d51db5dae1e4a0e410c3bb246ab}{}\label{bicorder_8c_a3ecb5d51db5dae1e4a0e410c3bb246ab}

\begin{DoxyCompactList}\small\item\em Wait for the given number of milliseconds. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_a8b6fdb62ade7de89237a256341bb45b3}{fill\+Screen} (e\+G\+F\+X\+\_\+\+Pixel\+State state)
\begin{DoxyCompactList}\small\item\em Fills the e\+G\+FX backbuffer with the given \#e\+G\+F\+X\+\_\+\+Pixel\+State. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_ab5e09814056d617c521549e542639b7e}{Sys\+Tick\+\_\+\+Handler} (void)\hypertarget{bicorder_8c_ab5e09814056d617c521549e542639b7e}{}\label{bicorder_8c_ab5e09814056d617c521549e542639b7e}

\begin{DoxyCompactList}\small\item\em Handler for the systick timer; increments counters, etc. \end{DoxyCompactList}\item 
void {\bfseries S\+W\+\_\+\+L\+E\+F\+T\+\_\+\+I\+R\+Q\+Handler} (void)\hypertarget{bicorder_8c_a63a7e0b57db08f38c8cf4a3612c7bd3c}{}\label{bicorder_8c_a63a7e0b57db08f38c8cf4a3612c7bd3c}

\item 
void {\bfseries S\+W\+\_\+\+R\+I\+G\+H\+T\+\_\+\+I\+R\+Q\+Handler} (void)\hypertarget{bicorder_8c_af25bac4db198e708981413bb040c77f0}{}\label{bicorder_8c_af25bac4db198e708981413bb040c77f0}

\item 
void {\bfseries A\+D\+C\+\_\+\+S\+E\+Q\+A\+\_\+\+I\+R\+Q\+Handler} (void)\hypertarget{bicorder_8c_afaada093ceb1db62803ff20ed6cf96c4}{}\label{bicorder_8c_afaada093ceb1db62803ff20ed6cf96c4}

\item 
float \hyperlink{bicorder_8c_a0bf61f89bd59729288d59afbc7d1a02f}{get\+Range\+Centimeters} (void)\hypertarget{bicorder_8c_a0bf61f89bd59729288d59afbc7d1a02f}{}\label{bicorder_8c_a0bf61f89bd59729288d59afbc7d1a02f}

\begin{DoxyCompactList}\small\item\em Retrieves the current measured range in centimeters. \end{DoxyCompactList}\item 
float \hyperlink{bicorder_8c_a218f56346195a635db9c44d9badcdaaa}{get\+Range\+Inches} (void)\hypertarget{bicorder_8c_a218f56346195a635db9c44d9badcdaaa}{}\label{bicorder_8c_a218f56346195a635db9c44d9badcdaaa}

\begin{DoxyCompactList}\small\item\em Retrieves the current measured range in inches. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_a96d82eb51fcc411bae93d32092b96501}{go\+To\+Sleep} (void)\hypertarget{bicorder_8c_a96d82eb51fcc411bae93d32092b96501}{}\label{bicorder_8c_a96d82eb51fcc411bae93d32092b96501}

\begin{DoxyCompactList}\small\item\em Enters sleep state until pinint signal received. \end{DoxyCompactList}\item 
void \hyperlink{bicorder_8c_a99d36e6369b4349026dd99b0cee66033}{wakeup} (void)\hypertarget{bicorder_8c_a99d36e6369b4349026dd99b0cee66033}{}\label{bicorder_8c_a99d36e6369b4349026dd99b0cee66033}

\begin{DoxyCompactList}\small\item\em Called upon waking from sleep to re-\/enable clocks, etc. \end{DoxyCompactList}\item 
int {\bfseries main} (void)\hypertarget{bicorder_8c_a840291bc02cba5474a4cb46a9b9566fe}{}\label{bicorder_8c_a840291bc02cba5474a4cb46a9b9566fe}

\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structC12832A__config}{C12832\+A\+\_\+config} {\bfseries g\+\_\+\+C12832A}\hypertarget{bicorder_8c_ad54be9924e125dc848b2db01283adb81}{}\label{bicorder_8c_ad54be9924e125dc848b2db01283adb81}

\item 
static \hyperlink{structHTU21D}{H\+T\+U21D} {\bfseries g\+\_\+\+H\+T\+U21D}\hypertarget{bicorder_8c_a47f536414bb79d7715cc7a4ffe3dfa38}{}\label{bicorder_8c_a47f536414bb79d7715cc7a4ffe3dfa38}

\item 
static \hyperlink{structHMC5883L}{H\+M\+C5883L} {\bfseries g\+\_\+\+H\+M\+C5883L}\hypertarget{bicorder_8c_aec16c5a6796bdfb30b51a8af83a174b9}{}\label{bicorder_8c_aec16c5a6796bdfb30b51a8af83a174b9}

\item 
static volatile \hyperlink{structuCorder__plot}{u\+Corder\+\_\+plot} {\bfseries g\+\_\+plot\+\_\+temp}\hypertarget{bicorder_8c_accc78f0f59722c4df530242fb3ab1d55}{}\label{bicorder_8c_accc78f0f59722c4df530242fb3ab1d55}

\item 
static volatile \hyperlink{structuCorder__plot}{u\+Corder\+\_\+plot} {\bfseries g\+\_\+plot\+\_\+rh}\hypertarget{bicorder_8c_a217ca8056ad81fe317749c3c3e63ba0c}{}\label{bicorder_8c_a217ca8056ad81fe317749c3c3e63ba0c}

\item 
static volatile \hyperlink{structuCorder__Compass}{u\+Corder\+\_\+\+Compass} {\bfseries g\+\_\+compass}\hypertarget{bicorder_8c_a81f51d77de4741463ef6d0ea57edaa0f}{}\label{bicorder_8c_a81f51d77de4741463ef6d0ea57edaa0f}

\item 
static volatile \hyperlink{structuCorder__plot}{u\+Corder\+\_\+plot} {\bfseries g\+\_\+plot\+\_\+mag}\hypertarget{bicorder_8c_a3f1a9a565db3a8d1334a6586e702c404}{}\label{bicorder_8c_a3f1a9a565db3a8d1334a6586e702c404}

\item 
static volatile uint32\+\_\+t {\bfseries g\+\_\+delayms\+\_\+counter}\hypertarget{bicorder_8c_aafef37b0cce3451df9b9d1c9e16a786c}{}\label{bicorder_8c_aafef37b0cce3451df9b9d1c9e16a786c}

\item 
static volatile uint32\+\_\+t {\bfseries g\+\_\+millis\+\_\+counter}\hypertarget{bicorder_8c_a5e6595d48640188402842c76906189fe}{}\label{bicorder_8c_a5e6595d48640188402842c76906189fe}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+adc\+\_\+sample\+\_\+ready} = 0\hypertarget{bicorder_8c_afecdbc8d62dc544149c3c6603947abdc}{}\label{bicorder_8c_afecdbc8d62dc544149c3c6603947abdc}

\item 
static volatile uint32\+\_\+t {\bfseries g\+\_\+range\+\_\+raw} = 0\hypertarget{bicorder_8c_a9d248441491a635c07f6d03f50a8ff85}{}\label{bicorder_8c_a9d248441491a635c07f6d03f50a8ff85}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+left\+\_\+display} = D\+I\+S\+P\+L\+A\+Y\+\_\+\+T\+E\+MP\hypertarget{bicorder_8c_a31135c909beeb10e9717e4ad097da218}{}\label{bicorder_8c_a31135c909beeb10e9717e4ad097da218}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+right\+\_\+display} = D\+I\+S\+P\+L\+A\+Y\+\_\+\+RH\hypertarget{bicorder_8c_af790bcc50f37599b4a81203cd444e91a}{}\label{bicorder_8c_af790bcc50f37599b4a81203cd444e91a}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+sw\+\_\+left\+\_\+debouncing} = 0\hypertarget{bicorder_8c_a4b43e42754dcb25b5404295de247ce59}{}\label{bicorder_8c_a4b43e42754dcb25b5404295de247ce59}

\item 
static volatile uint16\+\_\+t {\bfseries g\+\_\+sw\+\_\+left\+\_\+debounce\+\_\+counter}\hypertarget{bicorder_8c_af19f7da65976699643e49a6d93278ff4}{}\label{bicorder_8c_af19f7da65976699643e49a6d93278ff4}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+sw\+\_\+right\+\_\+debouncing} = 0\hypertarget{bicorder_8c_a8241f6a19cd11caf6d060b61c2de88b2}{}\label{bicorder_8c_a8241f6a19cd11caf6d060b61c2de88b2}

\item 
static volatile uint16\+\_\+t {\bfseries g\+\_\+sw\+\_\+right\+\_\+debounce\+\_\+counter}\hypertarget{bicorder_8c_a5a972e3ccde2c1a6b6b795f6e8633287}{}\label{bicorder_8c_a5a972e3ccde2c1a6b6b795f6e8633287}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+go\+\_\+to\+\_\+sleep}\hypertarget{bicorder_8c_aaca19eee1be26639eb2ace99b02c0d8e}{}\label{bicorder_8c_aaca19eee1be26639eb2ace99b02c0d8e}

\item 
static volatile uint8\+\_\+t {\bfseries g\+\_\+ignore\+\_\+switches}\hypertarget{bicorder_8c_a1f5c527285aae7b32ea545d2a972b218}{}\label{bicorder_8c_a1f5c527285aae7b32ea545d2a972b218}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
A Tricorder inspired project using the Gray Cat Labs Moon\+Lander. 

\begin{DoxyAuthor}{Author}
Alex Hiam -\/ \href{mailto:alex@graycat.io}{\tt alex@graycat.\+io}
\end{DoxyAuthor}
The Bicorder (not quite a Tricorder) currently has a 3-\/axis magnetometer, a relative humidity / temperature sensor and an infrared range finder. It uses a 128x32 pixel monochrome L\+CD from Newhaven, which is divided into left and right sections, each displaying one of\+:
\begin{DoxyItemize}
\item live plot of temperature (in Celsius)
\item live plot of relative humidity
\item live plot of magnetic field (Z-\/axis) in u\+Tesla
\item a compass display (using the mag X and Y)
\item a distance readout in cm
\end{DoxyItemize}

There\textquotesingle{}s plenty of room for improvement, such as adding an acceleromter for compass tilt compensation, switching to an ultrasonic range finder for higher accuracy and lower power, as well as just adding more sensors.

\begin{DoxySeeAlso}{See also}
\href{https://hackaday.io/project/9176-moonlander}{\tt https\+://hackaday.\+io/project/9176-\/moonlander} 

\href{https://github.com/graycatlabs/MoonLander}{\tt https\+://github.\+com/graycatlabs/\+Moon\+Lander} 
\end{DoxySeeAlso}


\subsection{Function Documentation}
\index{bicorder.\+c@{bicorder.\+c}!adc\+Init@{adc\+Init}}
\index{adc\+Init@{adc\+Init}!bicorder.\+c@{bicorder.\+c}}
\subsubsection[{\texorpdfstring{adc\+Init(void)}{adcInit(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void adc\+Init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{bicorder_8c_afd645b17cf0581bcaa22c56011c775e4}{}\label{bicorder_8c_afd645b17cf0581bcaa22c56011c775e4}


A\+DC initialization. 

Enables A\+DC and sets up the sequencer for single sample on the range finder A\+DC input. 

Definition at line 141 of file bicorder.\+c.

\index{bicorder.\+c@{bicorder.\+c}!fill\+Screen@{fill\+Screen}}
\index{fill\+Screen@{fill\+Screen}!bicorder.\+c@{bicorder.\+c}}
\subsubsection[{\texorpdfstring{fill\+Screen(e\+G\+F\+X\+\_\+\+Pixel\+State state)}{fillScreen(eGFX_PixelState state)}}]{\setlength{\rightskip}{0pt plus 5cm}void fill\+Screen (
\begin{DoxyParamCaption}
\item[{e\+G\+F\+X\+\_\+\+Pixel\+State}]{state}
\end{DoxyParamCaption}
)}\hypertarget{bicorder_8c_a8b6fdb62ade7de89237a256341bb45b3}{}\label{bicorder_8c_a8b6fdb62ade7de89237a256341bb45b3}


Fills the e\+G\+FX backbuffer with the given \#e\+G\+F\+X\+\_\+\+Pixel\+State. 


\begin{DoxyParams}{Parameters}
{\em state} & Pixel state to set all pixels to \\
\hline
\end{DoxyParams}


Definition at line 190 of file bicorder.\+c.

